"use strict";(self.webpackChunkheifetz=self.webpackChunkheifetz||[]).push([[887],{64099:function(t,e,o){o.d(e,{As:function(){return en},BU:function(){return eC},EN:function(){return t5},Ho:function(){return eS},RK:function(){return eb},RP:function(){return eA},S_:function(){return t6},TS:function(){return tq},Zd:function(){return eZ},cx:function(){return tM},fN:function(){return tD},p1:function(){return tK},pE:function(){return eB},rI:function(){return eh}});var n=o(9338),r=o(22107),a=o(94707),i=o(87320),c=o(55164),l=o(57477),u=o(71728),s=o(94009),d=o(79065),f=o(49899),h=o(30971),m=o(85879),g=o(87363),p=o(88329),v=o.n(p),A=o(69383);o(75570);var b=o(43384),k=o(65733),y=o(75798),w=o(91850),C=o(17103),x=o(83537),B=o(14168),L=o.n(B),_=o(25628),z=o.n(_),G=o(41402),S=o(37831),Z=o(92769),R=o.n(Z),I=o(88423),E=o(74135),T=o(76073),W=o.n(T),P=o(30722),D=o(7629),N=o(78842),K=o(48887),M=o.n(K),V=o(74351),q=o(18837),U=o.n(q),O=o(20072),H=o(61533),j=o(80565),Q=o(4667),F=o.n(Q),X=o(32193),Y=o(54231),J=o(57045),$=o(45401);function tt(){var t=(0,d._)(["\n   from { opacity: 0; }\n   to { opacity: 1; }\n"]);return tt=function(){return t},t}var te=function(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];return function(t){e.forEach(function(e){"function"==typeof e?e(t):e&&(e.current=t)})}};function to(t){var e=this;return t.length?function(o,n){for(var r=t.length-1,a=o;r>=0;)a=t[r].call(e,a,n),r--;return a}:v()}var tn=function(t){var e=function(t){if(0!==t.intersectionRatio){var e=t.target;e.dataset.zaDetailViewId=e.cardShowViewId,A.Z.trackCardShow(e,{},{link:{url:e.href}}),o.unobserve(e),e.clickViewId&&(e.dataset.zaDetailViewId=e.clickViewId)}},o=new IntersectionObserver(function(t){t.forEach(e)},{threshold:[.1]});return[{cardShowViewId:1042,clickViewId:1043,selector:"a.external, a.internal"},{cardShowViewId:1044,clickViewId:1045,selector:"a.member_mention, a.UserLink-link"},{cardShowViewId:174,clickViewId:175,selector:"a.video-box"},{cardShowViewId:171,clickViewId:172,selector:'a[data-draft-type="link-card"]'},{cardShowViewId:7692,selector:"a.FileLinkCard .FileLinkCard-info"},{cardShowViewId:9744,selector:".Catalog"}].forEach(function(e){var n=e.selector,r=e.cardShowViewId,a=e.clickViewId;Array.from(t.querySelectorAll(n)).forEach(function(t){t.cardShowViewId=r,t.clickViewId=a,o.observe(t)})}),function(){o.disconnect()}},tr="function"==typeof queueMicrotask?queueMicrotask:function(t){return Promise.resolve().then(t)},ta=function(t){var e=(0,g.useRef)(null);(0,g.useEffect)(function(){if(t)return tr(function(){t&&(e.current=tn(t))}),function(){e.current&&e.current()}},[t])},ti=function(t){return{elementLocation:{type:"Button",content:{type:t.dataset.zaContentType}}}},tc=function(t){return{attachedInfoBytes:t.dataset.zaAttachInfo}},tl=[{selector:"a.external, a.internal",zaBlock:"ZTextLink"},{selector:"a.member_mention, a.UserLink-link",zaBlock:"ZTextMention"},{selector:"a.video-box",zaBlock:"ZTextVideoCard"},{selector:'a.LinkCard.old[data-draft-type="link-card"]',zaBlock:"ZTextLinkCard"},{selector:'a.LinkCard.new.static[data-draft-type="link-card"]:not([data-za-content-type="Zvideo"])',zaBlock:"ZTextLinkCard",viewInfoBuilder:ti,extraInfoBuilder:tc},{selector:'a.LinkCard.new.static[data-draft-type="link-card"][data-za-content-type="Zvideo"]',zaBlock:"ZTextZVideoLinkCard",viewInfoBuilder:ti,extraInfoBuilder:tc},{selector:"a.FileLinkCard",zaBlock:"ZTextFileLinkCard"}],tu=function(t){var e,o,n=t.element,r=t.config,a=null===(e=r.viewInfoBuilder)||void 0===e?void 0:e.call(r,n,r),i=(0,c._)({elementLocation:{type:"Button"},block:r.zaBlock},a),l=(0,c._)({action:"OpenUrl",elementLocation:{type:"Button"},block:r.zaBlock,eventType:"Click"},a),u=(0,c._)({link:{url:n.href}},null===(o=r.extraInfoBuilder)||void 0===o?void 0:o.call(r,n,r)),s=(0,b.Q4)().trackEvent,d=(0,b.x3)(i,u),f=(0,k.Z)(function(t){s(l,u),"ZTextLinkCard"===r.zaBlock&&n.dataset.isEcommerce&&t.preventDefault()});return(0,g.useEffect)(function(){return n.addEventListener("click",f),function(){n.removeEventListener("click",f)}},[]),(0,g.useEffect)(function(){return d(n),function(){return d(null)}},[]),null},ts=function(t){var e=t.root,o=(0,s._)((0,g.useState)([]),2),n=o[0],r=o[1];return(0,g.useEffect)(function(){if(e){var t=[];tl.forEach(function(o){var n=o.selector;Array.from(e.querySelectorAll(n)).forEach(function(e){t.push({el:e,config:o})})}),r(t)}},[e]),(0,m.tZ)(g.Fragment,{children:n.map(function(t,e){var o=t.el,n=t.config;return(0,m.tZ)(tu,{element:o,config:n},e)})})},td=/<p><br><\/p>/g,tf=/<[^<>\s]+(\s|>)/,th=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solid";return{borderBottom:"1px ".concat(e," ").concat(t.colors.GBK05A)}},tm=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solid";return{borderBottom:"1px ".concat(e," ").concat(t.colors.GBL07A)}},tg=function(t){return{color:t.colors.GBL07A,"&:hover":tm(t)}},tp=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"[data-focus-visible]";return(0,i._)({outline:"none",transition:"box-shadow 0.3s"},"html".concat(e," &"),{boxShadow:"0 0 0 2px ".concat(t.colors.GBK99A,", 0 0 0 4px ").concat(t.colorMod(t.colors.GBL01A).alpha(.3))})},tv=(0,G.F4)(tt()),tA=function(t){var e="1.4em";return(0,c._)({wordBreak:"break-word",lineHeight:"1.6","> [data-first-child]":{marginTop:0},"> :last-child":{marginBottom:0},"h1,h2":{clear:"left",marginTop:"calc((".concat(e," * 2) / 1.2)"),marginBottom:"calc(".concat(e," / 1.2)"),fontSize:"1.2em",lineHeight:1.5,fontWeight:t.fontWeights.bold},"h3,h4,h5,h6":{clear:"left",marginTop:"calc((".concat(e," * 1.5) / 1.1)"),marginBottom:"calc(".concat(e," / 1.1)"),fontSize:"1.1em",lineHeight:"1.5",fontWeight:t.fontWeights.bold},u:{textDecoration:"none",borderBottom:"1px solid ".concat(t.colors.GBK03A)},b:{fontWeight:t.fontWeights.bold},sup:{fontSize:"0.8em"},"sup[data-draft-type='reference']":{color:t.colors.GBL07A},"a:focus":tp(t),"a.ztext-link,a.internal,a.external":(0,l._)((0,c._)({textDecoration:"none",cursor:"pointer"},th(t)),{"&:hover":(0,c._)({color:t.colors.GBL07A},tm(t))," > .ellipsis::after":{content:"'...'"},"> .invisible":{font:"0/0 a",color:"transparent",textShadow:"none",backgroundColor:"transparent"},u:{border:"none"}}),"a.member_mention":tg(t),"a.UserLink-link":tg(t),p:{margin:"".concat(e," 0")},"p.ztext-empty-paragraph":{margin:"calc((".concat("2.8em","- (").concat(e," * 2 + 1.6em)) / 2) 0"),"+ .ztext-empty-paragraph":{margin:"".concat(e," 0")}},hr:{margin:"4em auto",width:"240px",maxWidth:"100%",border:"none",borderTop:"1px solid ".concat(t.colors.GBK08A)},"img[eeimg]":(0,c._)({maxWidth:"100%",verticalAlign:"middle"},t.isDarkMod&&{filter:"invert(1)"}),'img[eeimg="1"]':{margin:"0 3px",maxWidth:"calc(100% - 6px)",display:"inline-block"},'img[eeimg="2"]':{margin:"".concat(e," auto"),display:"block"},blockquote:{margin:"".concat(e," 0"),paddingLeft:"1em",color:t.colors.GBK04A,borderLeft:"3px solid ".concat(t.colors.GBK08A)},"ol,ul":{margin:"".concat(e," 0"),padding:0,width:"100%","ol,ul":{margin:0},"li::before":{width:"1em"},"> ol, > ul":{paddingLeft:"1em",boxSizing:"border-box"}},ul:{"&>li":{display:"table",width:"100%",listStyle:"none","&::before":{display:"table-cell",content:"'•  '",whiteSpace:"pre"}}},ol:{counterReset:"ol","> li":{display:"table",width:"100%",listStyle:"none","&::before":{display:"table-cell",textAlign:"right",counterIncrement:"ol",content:"counter(ol) '. '",whiteSpace:"pre"}}},"ol ol":{counterReset:"ol2","li::before":{counterIncrement:"ol2",content:"counter(ol2) '. '"}},"ol ol ol":{counterReset:"ol3","li::before":{counterIncrement:"ol3",content:"counter(ol3) '. '"}},"ol ol ol ol":{counterReset:"ol4","li::before":{counterIncrement:"ol4",content:"counter(ol4) '. '"}},figure:{margin:"".concat(e," 0"),".content_image,.origin_image":{margin:"0 auto"},figcaption:{marginTop:"calc(0.6em / 0.9)",padding:"0 1em",fontSize:"0.9em",lineHeight:"1.5",textAlign:"center",color:t.colors.GBK06A},"& + figure":{marginTop:"calc(".concat(e," * 1.6)")},"&[data-size='small'],&:not([data-size]) > [data-size='small']":{clear:"both"},"&[data-size='left'],&:not([data-size]) > [data-size='left']":{float:"left",margin:"0 20px 20px 0",maxWidth:"33%"},"&[data-size='right'],&:not([data-size]) > [data-size='right']":{float:"right",margin:"0 0 20px 20px",maxWidth:"33%"},"&[data-size='collapse']":{marginBottom:0,"& + figure":{marginTop:0}}},".content_image, .origin_image":{display:"block",maxWidth:"100%",height:"auto",margin:"".concat(e," auto"),"&[data-size='small']":{maxWidth:"40%"},"&.zh-lightbox-thumb":{cursor:"zoom-in"}},code:{margin:"0 2px",padding:"3px 4px",borderRadius:"3px",fontFamily:t.fonts.monospace,fontSize:"0.9em",backgroundColor:t.colors.GBK10A},pre:{margin:"".concat(e," 0"),padding:"calc(0.8em / 0.9)",fontSize:"0.9em",wordBreak:"initial",wordWrap:"initial",whiteSpace:"pre",overflow:"auto",WebkitOverflowScrolling:"touch",background:t.colors.GBK10A,borderRadius:"4px",code:{margin:0,padding:0,fontSize:"inherit",borderRadius:0,backgroundColor:"inherit"}},"li pre":{whiteSpace:"pre-wrap"},"table[data-draft-type='table']":{borderCollapse:"collapse",fontSize:"15px",margin:"".concat(e," auto"),maxWidth:"100%",tableLayout:"fixed",textAlign:"left",width:"100%","&[data-size='small']":{minWidth:"260px",width:"40%"},"&[data-row-style='striped'] tr:nth-of-type(2n + 1)":{background:t.colors.GBK10A},"td,th":{border:"1px solid ".concat(t.colors.GBK08A),lineHeight:"24px",height:"24px",padding:"3px 12px"},th:{background:t.colors.GBK09A,color:t.colors.GBK02A,fontWeight:500}},"& .video-box, & .link-box":{position:"relative",display:"flex",justifyContent:"space-between",margin:"".concat(e," 0"),overflow:"auto",whiteSpace:"normal",cursor:"pointer",border:"solid 1px ".concat(t.colors.GBK09A),borderRadius:"4px"}},{".lazy[data-lazy-status]":{backgroundColor:t.colors.GBK10A},'.lazy[data-lazy-status="ok"]':{backgroundColor:"transparent",animation:"".concat(tv," 0.5s ease-in")}})},tb=[function(t){return t?t.replace(td,'<p class="ztext-empty-paragraph"><br /></p>'):t},function(t){return t?t.replace(tf,function(t,e){return t.replace(e," data-first-child".concat(e))}):t}],tk=(0,g.forwardRef)(function(t,e){var o,n=t.as,r=t.tag,a=t.className,i=t.html,l=t.clearBoth,s=void 0!==l&&l,d=t.richContentKey,f=t.root,h=t.Portal,g=t.useHooks,p=(0,u._)(t,["as","tag","className","html","clearBoth","richContentKey","root","Portal","useHooks"]),v=to(tb);g(f);var A=null!==(o=null!=n?n:r)&&void 0!==o?o:"div";return(0,m.BX)(m.HY,{children:[h&&(0,m.tZ)(h,{root:f}),(0,m.tZ)(A,(0,c._)({ref:e,css:function(t){return(0,c._)({},tA(t),{"& .highlight":{margin:"1em 0",pre:{margin:0},".hll":{backgroundColor:t.colors.GBK12A},".c":{fontStyle:"italic",color:t.colors.GBK06A},".err":{color:t.colors.GRD03A},".k":{fontWeight:t.fontWeights.bold},".o":{fontWeight:t.fontWeights.bold},".cm":{fontStyle:"italic",color:t.colors.GBK06A},".cp":{fontWeight:t.fontWeights.bold,color:t.colors.GBK06A},".c1":{fontStyle:"italic",color:t.colors.GBK06A},".cs":{fontStyle:"italic",fontWeight:t.fontWeights.bold,color:t.colors.GBK06A},".gd":{color:t.colors.GRD01A},".ge":{fontStyle:"italic"},".gr":{color:t.colors.GRD03A},".gh":{color:t.colors.GBK06A},".gi":{color:"#12b370"},".go":{color:t.colors.GBK05A},".gp":{color:t.colors.GBK04A},".gs":{fontWeight:t.fontWeights.bold},".gu":{color:t.colors.GBK06A},".gt":{color:t.colors.GRD03A},".kc":{fontWeight:t.fontWeights.bold},".kd":{fontWeight:t.fontWeights.bold},".kn":{fontWeight:t.fontWeights.bold},".kp":{fontWeight:t.fontWeights.bold},".kr":{fontWeight:t.fontWeights.bold},".kt":{fontWeight:t.fontWeights.bold,color:t.colors.GBL07A},".m":{color:t.colors.GBL01A},".s":{color:t.colors.GRD03A},".na":{color:t.colors.GBL01A},".nb":{color:t.colors.GBL01A},".nc":{fontWeight:t.fontWeights.bold,color:t.colors.GBL07A},".no":{color:t.colors.GBL01A},".ni":{color:t.colors.GRD07A},".ne":{fontWeight:t.fontWeights.bold,color:t.colors.GRD03A},".nf":{fontWeight:t.fontWeights.bold,color:t.colors.GRD03A},".nn":{color:t.colors.GBK04A},".nt":{color:t.colors.GBL07A},".nv":{color:t.colors.GBL01A},".ow":{fontWeight:t.fontWeights.bold},".w":{color:t.colors.GBK07A},".mf":{color:t.colors.GBL01A},".mh":{color:t.colors.GBL01A},".mi":{color:t.colors.GBL01A},".mo":{color:t.colors.GBL01A},".sb":{color:t.colors.GRD03A},".sc":{color:t.colors.GRD03A},".sd":{color:t.colors.GRD03A},".s2":{color:t.colors.GRD03A},".se":{color:t.colors.GRD03A},".sh":{color:t.colors.GRD03A},".si":{color:t.colors.GRD03A},".sx":{color:t.colors.GRD03A},".sr":{color:t.colors.GYL02A},".s1":{color:t.colors.GRD03A},".ss":{color:t.colors.GRD03A},".bp":{color:t.colors.GBK06A},".vc":{color:t.colors.GBL01A},".vg":{color:t.colors.GBL01A},".vi":{color:t.colors.GBL01A},".il":{color:t.colors.GBL01A},"&::-webkit-scrollbar":{width:"6px",height:"6px"},"&::-webkit-scrollbar-thumb:horizontal":{backgroundColor:t.colorMod(t.colors.GBK02A).alpha(.5),borderRadius:"6px","&:hover":{backgroundColor:t.colorMod(t.colors.GBK02A).alpha(.6)}}}},s&&{"&::before, &::after":{clear:"both",content:'""',display:"block"}})},className:z()("RichText","ztext",a,{"RichText--clearBoth":s}),dangerouslySetInnerHTML:{__html:v(i)}},p),d||i)]})});tk.propTypes={as:L().string,tag:L().string,html:L().string.isRequired,clearBoth:L().bool,ref:L().func,Portal:L().func,useHooks:L().func},tk.defaultProps={useHooks:v()};var ty=(0,g.memo)(tk),tw=function(t,e){if(t>0&&e>0){var o=t/e;if(o>1.2)return"180x120";if(o<=.8)return"120x160"}return"ipico"},tC=(0,g.forwardRef)(function(t,e){var o=R()(t,["entityType","entityData","notCommerce"]),n=o.text,r=o.target,a=o.url,i=o.image,s=o.imageWidth,d=o.imageHeight,f=o.component,h=o.className,g=o.size,p=o.children,v=(0,u._)(o,["text","target","url","image","imageWidth","imageHeight","component","className","size","children"]),A=tw(s,d),b=(0,I.imgUrl)(i,A);return(0,m.tZ)(f,(0,l._)((0,c._)((0,l._)((0,c._)({ref:e,target:r,href:a,"data-draft-node":"block","data-draft-type":"link-card"},b&&{"data-image":b},s&&{"data-image-width":s},d&&{"data-image-height":d},g&&{"data-size":g},n!==a&&n&&{"data-text":n}),{className:z()("LinkCard new",h)}),v),{children:p||(0,m.BX)(m.HY,{children:[(0,m.BX)("span",{className:"LinkCard-contents",children:[(0,m.tZ)("span",{className:"LinkCard-title loading","data-text":!0}),(0,m.tZ)("span",{className:"LinkCard-desc loading"})]}),(0,m.tZ)("span",{className:"LinkCard-image LinkCard-image--default"})]})}))});tC.propTypes={component:L().oneOfType([L().string,L().func]),target:L().string,url:L().string.isRequired,text:L().string,image:L().string,imageWidth:L().oneOfType([L().string,L().number]),imageHeight:L().oneOfType([L().string,L().number])},tC.defaultProps={component:"a",target:"_blank"};var tx={answer:"回答",article:"文章",zvideo:"视频",question:"问题",collection:"收藏夹",roundtable:"圆桌",topic:"话题"},tB={voteupCount:"赞同",commentCount:"评论",playCount:"播放",followerCount:"关注",answerCount:"回答",visitCount:"浏览",discussionCount:"讨论"},tL={answer:["voteupCount","commentCount"],article:["voteupCount","commentCount"],zvideo:["playCount","voteupCount"],question:["followerCount","answerCount"],collection:["visitCount","followerCount"],topic:["visitCount","discussionCount"],default:["followerCount","visitCount"]},t_=function(t){var e=t.twoLine,o=t.children;return!!o&&(0,m.tZ)("span",{className:z()("LinkCard-title",{"two-line":e}),children:o})},tz=function(t){var e=t.data,o=e.objectType,n=(tL[o]||tL.default).map(function(t){var o=e[t];return"".concat((0,P.Zh)(o)).concat(tB[t])}).filter(Boolean).join(" \xb7 ");return(0,m.BX)("span",{className:"LinkCard-desc",children:[n,(0,m.tZ)("span",{className:"LinkCard-tag",children:tx[o]})]})},tG=function(t){var e=t.url,o=(0,g.useMemo)(function(){var t=null,o=W()(e,!0);return"link.zhihu.com"===o.hostname&&(t=o.query.target),(t||e).replace(/^https?:\/\//,"")},[e]);return(0,m.BX)("span",{className:"LinkCard-desc",children:[(0,m.tZ)(D.n,{size:14,center:!0}),o]})},tS=function(t){var e=t.url,o=t.isVideo,n=t.ratio,r=t.onClick;return!!e&&(0,m.BX)("span",{className:"LinkCard-image",style:{height:60*(void 0===n?1:n)},children:[(0,m.tZ)("img",{src:e,onClick:r,alt:o?"点击可播放视频":""}),o&&(0,m.tZ)("span",{className:"LinkCard-image--video",children:(0,m.tZ)(N.D,{size:10,center:!0})})]})},tZ=(0,g.forwardRef)(function(t,e){var o=t.url,n=t.data,r=t.onClick,a=t.onClickImage,i=n.title,c=n.thumbnail,l=n.objectType;return(0,m.BX)(m.HY,{children:[(0,m.BX)("span",{ref:e,className:"LinkCard-contents",onClick:r,children:[(0,m.tZ)(t_,{twoLine:!0,children:i}),l?(0,m.tZ)(tz,{data:n}):(0,m.tZ)(tG,{url:o})]}),(0,m.tZ)(tS,{url:c,isVideo:"zvideo"===l,onClick:a})]})}),tR=function(t){var e=t.className,o=t.html;return o?(0,m.tZ)("span",{className:"LinkCard-richText ".concat(e),dangerouslySetInnerHTML:{__html:"<object>".concat(o,"</object>")}}):null},tI=function(t){var e=t.data,o=e.title,n=e.desc,r=e.url,a=e.image,i=e.ratio,c=e.isVideo;return(0,m.BX)(m.HY,{children:[(0,m.BX)("span",{className:"LinkCard-contents",children:[(0,m.tZ)(t_,{twoLine:!0,children:o},"title"),(0,m.tZ)(tR,{className:"LinkCard-desc",html:n}),!n&&(0,m.tZ)(tG,{url:r},"url")]}),(0,m.tZ)(tS,{url:a,ratio:i,isVideo:c})]})},tE={ANSWER:"Answer",ARTICLE:"Column",ZVIDEO:"Zvideo",QUESTION:"Question",COLLECTION:"Collection",ROUNDTABLE:"Roundtable",SPECIAL:"Special",TOPIC:"Topic"},tT=function(t){var e={};if(t.data){var o=(0,E.camelizeKeys)("string"==typeof t.data?JSON.parse(t.data):t.data),n=o.source,r=o.display,a=void 0===r?{}:r,i=o.zaData,u=a.cardOpenUrl,s=a.title,d=a.content,f=a.desc,h=a.image||{};e={source:void 0===n?{}:n,url:u,title:s,content:d,desc:f,image:h.imageUrl,ratio:h.ratio,isVideo:h.isVideo,zaAttachInfo:(void 0===i?{}:i).attachInfo}}return(0,l._)((0,c._)({},e,t),{title:t.text||e.title,image:e.image||t.image})},tW=(0,g.forwardRef)(function(t,e){var o=(0,g.useMemo)(function(){return tT(t)},[t]),n=o.source,r=o.target,a=o.title,i=o.url,c=o.zaAttachInfo;return(0,m.tZ)(tC,{ref:e,notCommerce:!0,target:r,text:a,url:i,"data-za-attach-info":c,"data-za-content-type":tE[null==n?void 0:n.contentType]||"Unknown",className:"static",children:(0,m.tZ)(tI,{data:o})})}),tP=/([-\w]+)(="([^"]+)"|='([^']+)')?/g,tD=function(t){for(var e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=o.decodeValue,r=void 0!==n&&n,a={};e=tP.exec(t);){var i=e[1],c=e[3]||e[4];a[i]=(r?tK(c):c)||""}return a},tN=function(t){if(!t)return null;try{return JSON.parse(t)}catch(t){return null}};function tK(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.replace(/&amp;/g,"&").replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#34;/g,'"').replace(/&#13;/g,"\r")}function tM(){return Math.max(window.innerHeight/10,100)}var tV=function(t){for(var e=t;e&&"HTML"!==e.tagName&&"BODY"!==e.tagName&&1===e.nodeType;){var o=document.defaultView.getComputedStyle(e);if([o.overflow,o.overflowY,o.overflowX].some(function(t){return"scroll"===t||"auto"===t}))return e;e=e.parentNode||e.parentElement}return window};function tq(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=tV(t),r=t.getBoundingClientRect().top+(n.pageYOffset||n.scrollTop||0)-(o?tM():0)-e;n.scrollTo({top:r,behavior:"smooth"})}var tU=/<a\b([^>]*data-draft-type="link-card"[^>]*)>(.*?)<\/a>/g,tO=function(t){var e=t.target,o=t.url,n=t.component,r=t.className;return(0,m.tZ)(n,{target:e,href:o,"data-draft-node":"block","data-draft-type":"link-card","data-is-ecommerce":"1",className:z()("LinkCard",r),children:(0,m.BX)("span",{className:"LinkCard-content LinkCard-ecommerceLoadingCard",children:[(0,m.tZ)("div",{className:"LinkCard-ecommerceLoadingCardAvatarWrapper",children:(0,m.tZ)("img",{src:"https://pic2.zhimg.com/v2-1b0bbef27f0496a58468f92d94c8a80e_l.png",className:"LinkCard-ecommerceLoadingCardNetwork"})}),(0,m.BX)("div",{className:"LinkCard-ecommerceLoadingCardLoadingbar",children:[(0,m.tZ)("span",{}),(0,m.tZ)("span",{})]})]})})};tO.defaultProps={component:"a",target:"_blank"};var tH=/<a\b([^>]*BIZ(=|%3D)ECOMMERCE[^>]*)>(.*?)<\/a>/g,tj=function(){function t(e){var o,n,a=this;(0,r._)(this,t),o="fetch",n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a.url||(a.url=t),t!==a.url)throw Error("mismatch url\n".concat(t,"\n").concat(a.url),t,a.url);return new Promise(function(t,o){a.addToQueue({options:e,resolve:t,reject:o})})},o in this?Object.defineProperty(this,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[o]=n,this.instance=null,this.customFetch=e,this.delay=200,this.maxDelay=1e3,this.url="",this.queueMaxLength=10,this.queue=[],this.startTime=Date.now(),this.timeout=null,this.initialized=!1}return(0,a._)(t,[{key:"initConfig",value:function(t){var e=t.delay,o=t.maxDelay,n=t.maxBatchCount;e&&(this.delay=e),o&&(this.maxDelay=o),n&&(this.maxBatchCount=n),this.initialized=!0}},{key:"buildFetchParams",value:function(t){var e=(0,s._)(t,1)[0].options,o=t.reduce(function(t,e){var o,n;return(null===(n=(o=e.options).dataBuilder)||void 0===n?void 0:n.call(o,t,e))||t},{}),n=this.url,r=!e.method||"GET"===e.method.toUpperCase();if(r){var a=W()(n,!0);a.query=(0,c._)({},a.query,o),n=a.toString()}return[n,(0,l._)((0,c._)({},e),{data:r?null:(0,c._)({},e.data,o)})]}},{key:"doFetch",value:function(){var t=this;return(0,n._)(function(){var e,o,n;return(0,h.__generator)(this,function(r){switch(r.label){case 0:if(0===t.queue.length)return[2];e=t.queue,t.queue=[],r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.customFetch.apply(t,(0,f._)(t.buildFetchParams(e)))];case 2:return o=r.sent(),e.forEach(function(t){var e=t.options;(0,t.resolve)(e.resultBuilder?e.resultBuilder(o):o)}),[3,4];case 3:return n=r.sent(),e.forEach(function(t){return t.reject(n)}),[3,4];case 4:return[2]}})})()}},{key:"addToQueue",value:function(t){var e=this;this.initialized||this.initConfig(t.options),clearTimeout(this.timeout),(Date.now()-this.startTime>this.maxDelay||this.queue.length>=this.maxBatchCount)&&(this.startTime=Date.now(),this.doFetch()),this.queue.push(t),setTimeout(function(){e.startTime=Date.now(),e.doFetch()},this.delay)}}]),t}(),tQ=null,tF=function(t){var e;return e=(0,n._)(function(e,o){return(0,h.__generator)(this,function(n){switch(n.label){case 0:return[4,t(e,o)];case 1:return[4,n.sent().json()];case 2:return[2,E.camelizeKeys.apply(void 0,[n.sent()])]}})}),function(t,o){return e.apply(this,arguments)}},tX=function(){throw Error("Not implemented")},tY=function(){var t;return t=tF("undefined"!=typeof fetch?fetch:tX),function(e,o){return tQ||(tQ=new tj(t)),tQ.fetch(e,o)}},tJ="https://www.zhihu.com/api/v4/link_card_infos",t$=U()(function(){if(!(0,V.isBrowser)())return tJ;var t=window.location,e=t.hostname,o=t.origin;return[".zpres.zhihu.dev",".zpres.zhihu.com"].some(function(t){return e.endsWith(t)})?"".concat(o,"/api/v4/link_card_infos"):tJ}),t0={},t1=function(t){var e=(0,g.useRef)(0),o=t.inEditor,r=t["data-offset-key"],a=t["data-text"],i=t["data-image"],u=t.href,d=(0,g.useRef)(!1),f=(0,g.useRef)(u),m="draftjs"===o,p=(0,s._)((0,g.useState)(function(){return m&&t0[r]||null}),2),v=p[0],A=p[1],b=(0,s._)((0,y.Z)({once:!0}),2),w=b[0],C=b[1],x=(0,k.Z)(function(t){var e=t||v;if(!e||0===Object.keys(e).length)return{objectType:null,title:a||u,thumbnail:i};e.title=a||e.title||u,e.thumbnail=i||e.thumbnail;var o=(0,l._)((0,c._)({},e),{cached:!0});return m&&(t0[r]=o),o}),B=(0,k.Z)(tY()),L=(0,k.Z)((0,n._)(function(){return(0,h.__generator)(this,function(t){switch(t.label){case 0:e.current+=1,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,B(t$(),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"},dataBuilder:function(t){return t.urls="".concat(t.urls?t.urls+",":"").concat(u),t},resultBuilder:function(t){return t[u]}})];case 2:return A(x(t.sent())),[3,4];case 3:return t.sent(),e.current<=1?L():A(x()),[3,4];case 4:return[2]}})}));return(0,g.useEffect)(function(){(!C||v&&v.cached)&&f.current===u||L()},[C,v,L,u]),(0,g.useEffect)(function(){o&&d.current&&A(x(f.current!==u?{title:a}:null))},[o,x,a,u]),(0,g.useEffect)(function(){f.current=u},[u]),(0,g.useEffect)(function(){d.current=!0},[]),[w,v]},t2=function(t){A.Z.trackCardShow(t,{id:7844},{button:{text:"inlinezvideo"}})},t4=function(t,e,o){var n;A.Z.trackEvent(t.target,{id:7846,action:"OpenUrl"},{button:{text:"inlinezvideo"}}),null==e||null===(n=e.onImageClick)||void 0===n||n.call(e,t,o)},t3=function(t,e,o){var n;A.Z.trackEvent(t.target,{id:7846,action:"OpenUrl"},{button:{text:"inlinezvideo"}}),null==e||null===(n=e.onImageClick)||void 0===n||n.call(e,t,o)},t8=function(t,e,o){var n=t["data-text"],r=t.href,a=t.zvideoLinkCardProps;(0,g.useEffect)(function(){o&&(0,O.y3)(e.current,function(){return t2(e.current)})},[o,e]);var i=(0,k.Z)(function(t){t4(t,{title:n,url:r,video:{}})}),c=(0,k.Z)(function(t){t3(t,a,{title:n,url:r})});return o?{handleImageClick:i,handleInfoClick:c}:{}},t7={answer:"Answer",article:"Column",zvideo:"Zvideo",question:"Question",collection:"Collection",roundtable:"Roundtable",topic:"Topic"},t6=g.forwardRef(function(t,e){var o=R()(t,["zvideoLinkCardProps"]),n=o.inEditor,r=o["data-text"],a=o.href,i=o.zaBlock,d=(0,u._)(o,["inEditor","data-text","href","zaBlock"]),f=(0,g.useRef)(),h=(0,s._)(t1(t),2),p=h[0],v=h[1],A=t8(t,f,(null==v?void 0:v.objectType)==="zvideo"),k=A.handleImageClick,y=A.handleInfoClick,w=(0,g.useCallback)(te(e,p,f),[]),C=n?tZ:b.$U,x=(0,m.tZ)(C,(0,l._)((0,c._)({},n?null:{as:tZ,shouldTrackShow:!0,zaText:!0,zaType:"Button",zaAction:"OpenUrl",zaBlock:i,extra:{link:{url:a}},"data-za-module":"Content"}),{url:a,data:v,onClick:y,onClickImage:k}));return(0,m.tZ)(tC,(0,l._)((0,c._)({ref:w,text:r,url:a,component:"a"},d),{children:!!v&&(0,m.tZ)(b.eV,{content:{type:t7[v.objectType]||"Unknown"},children:x})}))}),t9=function(t){var e=t.idAttr,o=t.targetClassName;return function(t){var n=t.getAttribute(e),r=document.createElement("div");return r.className=o,t.parentNode.replaceChild(r,t),{data:{id:n},target:r}}},t5=function(t){return function(e){var o=(0,s._)((0,g.useState)(null),2),n=o[0],r=o[1],a=t.idAttr,i=t.selector,l=t.component,d=t.targetClassName,f=t.cardDataFilter,h=t.getCardProps,p=e.root,A=(0,u._)(e,["root"]),b=a&&i&&d&&(0,g.useCallback)(function(t){return t9({idAttr:a,targetClassName:d})(t)},[a,d]),k=(0,g.useMemo)(function(){return b?function(t){return Array.from(t.querySelectorAll(i)).map(b)}:v()},[b,p,i]);return(0,g.useEffect)(function(){if(p||i&&f){var t=(f||k)(p).map(function(t){var e=t.data,o=t.target,n=null;return"function"==typeof h&&(n=h(e)),(0,H.createPortal)((0,m.tZ)(l,(0,c._)({id:e.id},n,A),e.id),o)});t.length>0&&r(t)}},[p]),n}},et=t5({cardDataFilter:function(t){return Array.from(t.querySelectorAll("a.LinkCard[data-draft-type=link-card]:not([data-is-ecommerce])")).map(function(t){var e=Array.from(t.attributes).reduce(function(t,e){return"class"===e.name?t.className=e.value:t[e.name]=e.value,t},{}),o=document.createElement("div");return o.className="RichText-LinkCardContainer",t.parentNode.replaceChild(o,t),{data:e,target:o}})},getCardProps:function(t){return t.href&&t.href.match(/https:\/\/www.zhihu.com\/zvideo\/(\d+)$/)?t.zaBlock="ZTextZVideoLinkCard":t.zaBlock="ZTextLinkCard",t},component:t6}),ee=function(t){return{".LinkCard.old":{position:"relative",display:"block",margin:"1em auto",width:390,boxSizing:"border-box",borderRadius:12,maxWidth:"100%",overflow:"hidden","&,&:hover":{textDecoration:"none",border:"none !important",color:"inherit !important"}},".LinkCard-ecommerceLoadingCard":{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",padding:12,borderRadius:"inherit",height:80,boxSizing:"border-box",background:t.colorMod(t.colors.GBK10A).alpha(.88),color:t.colors.GBK08A},".LinkCard-ecommerceLoadingCardAvatarWrapper":{width:60,height:60,background:t.colors.GBK09A,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:6,marginRight:10},".LinkCard-ecommerceLoadingCardNetwork":{width:20,height:20},".LinkCard-ecommerceLoadingCardLoadingbar":{height:60,flex:1,display:"flex",flexDirection:"column",span:{height:16,display:"inline-block",background:t.colors.GBK09A},"span:nth-of-type(1)":{width:60,marginBottom:4},"span:nth-of-type(2)":{width:127}}}},eo=function(t){return{".LinkCard.new":{position:"relative",display:"flex",boxSizing:"border-box",flexDirection:"row",alignItems:"center",width:390,minHeight:84,borderRadius:8,maxWidth:"100%",overflow:"hidden",margin:"16px auto",padding:"12px 12px 9px 12px",backgroundColor:t.colors.GBK10A,"&, &:hover":{textDecoration:"none",border:"none !important",color:"inherit !important"},".LinkCard-contents":{display:"block",flex:"1 1 auto",position:"relative",".loading":{height:14,background:t.colors.GBK09A,borderRadius:7},"&.withTitle":{marginBottom:3}},".LinkCard-title":(0,l._)((0,c._)({display:"block",fontSize:15,fontWeight:500,lineHeight:1.4,marginBottom:2,color:t.colors.GBK02A},(0,j.S)(1)),{"&.two-line":(0,c._)({lineHeight:"20px"},(0,j.S)(2)),"&.loading":{marginBottom:8,width:"80%","&.withTitle":{marginBottom:6}},"&.loadingTitle":{marginBottom:5}}),".LinkCard-excerpt":(0,l._)((0,c._)({display:"block",textOverflow:"ellipsis",fontSize:13,lineHeight:"18px",color:t.colors.GBK06A,marginBottom:4},(0,j.S)(1)),{".LinkCard-author":{color:t.colors.GBK03A}}),".LinkCard-desc":(0,l._)((0,c._)({display:"block",fontSize:13,height:18,lineHeight:"18px",color:t.colors.GBK06A,wordBreak:"break-all"},(0,j.S)(1)),{".LinkCard-tag,.tag":{display:"inline-block",fontSize:11,marginLeft:8,padding:"0 4px",borderRadius:3,background:t.colorMod(t.colors.GBK08A).alpha(.3)},"&.loading":{width:"40%"},svg:{marginRight:2}}),".LinkCard-image":{flex:"0 0 auto",backgroundColor:t.colors.GBK09A,backgroundSize:"cover",backgroundPosition:"center",position:"relative",display:"block",width:60,height:60,marginLeft:20,objectFit:"cover",borderRadius:"inherit",overflow:"hidden","&.LinkCard-image--default":{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:t.colors.GBK09A,color:t.colors.GBK08A,svg:{color:t.colors.GBK06A}},img:{width:"100%",height:"100%",objectFit:"cover"},".LinkCard-image--video":{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"50%",left:"50%",transform:"translateX(-50%) translateY(-50%)",width:24,height:24,borderRadius:12,background:t.colorMod(t.colors.GBK99C).alpha(.9),pointerEvents:"none",svg:{color:t.colors.GBK03A}}},".LinkCard-richText":{".text":{color:t.colors.GBK03A},".bold":{fontWeight:t.fontWeights.bold},".tag":{marginLeft:4}}}}},en=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch(t,(0,c._)({credentials:"include",headers:{"X-Requested-With":"Fetch"}},e)).then(function(t){return t.json()})},er=function(t){return(0,c._)({},ee(t),eo(t))},ea=function(t){return(0,c._)({},eo(t),ee(t))},ei=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=o.rootMargin,r=o.threshold,a=o.once,i=void 0===a||a;t=Array.isArray(t)?t:t?[t]:[];var c=(0,g.useRef)(null),l=(0,k.Z)(e);(0,g.useEffect)(function(){if(t.length)return c.current&&t.forEach(function(t){return c.current.unobserve(t)}),c.current=new IntersectionObserver(function(t){t.forEach(function(t){t.intersectionRatio>0&&(l(t),i&&c.current.unobserve(t.target))})},{rootMargin:n,threshold:r}),t.forEach(function(t){return c.current.observe(t)}),function(){t.forEach(function(t){return c.current.unobserve(t)})}},[t,n,JSON.stringify(r),i])},ec=o(18837),el="function"==typeof Image,eu={},es=el?ec(function(t){return new Promise(function(e){var o,n;return o=function(t,o){eu[t]=o,e(o)},void((n=new Image).onload=function(){var e=n.width>0&&n.height>0;o(t,e)},n.onerror=function(){o(t,!1)},n.src="data:image/webp;base64,"+({lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"})[t])})}):function(){return Promise.resolve(!1)},ed=function(t){var e=eu[t],o=(0,s._)((0,g.useState)(e),2),n=o[0],r=o[1];return el&&void 0===e&&es(t).then(r),n},ef={class:"className"},eh=(0,g.forwardRef)(function(t,e){var o=t.node,n=t.tagName,r=(0,u._)(t,["node","tagName"]),a=(0,g.useMemo)(function(){return Array.from(o.attributes).reduce(function(t,e){var o=ef[e.name]||e.name;return"style"!==o&&(t[o]=e.value),t},{})},[o]);return(0,g.createElement)(n||o.tagName.toLowerCase(),(0,l._)((0,c._)({},a,r),{ref:e}))}),em=F()(function(){return/Mobile/.test(navigator.userAgent)}),eg=function(t){var e=t.image,o=t.enableWebP,n=t.size,r=t.quality,a=e.dataset,i=a.actualsrc,c=a.actualgif;return o&&c&&c.match(/.gif$/i)?i:(n||(n="720w",!em()&&window.devicePixelRatio>=1.5&&(n="1440w"),em()&&window.devicePixelRatio*window.innerWidth>=1080&&(n="1440w")),(0,I.imgUrl)(i,{quality:void 0===r?80:r,size:n}))};function ep(t,e){A.Z.trackMonitor({name:e},{monitor:{type:"Event",imgResourceErrorInfo:{error_description:e,img_url:t,img_from:"web"}}})}var ev=function(t){var e=t.onLoadStateChange,o=t.onImageLoaded,n=t.enableWebP,r=t.size,a=t.quality;return function(t){var i=t.target,c=eg({image:i,enableWebP:n,size:r,quality:a});if(n&&(c=c.replace(/\.(jpg|png|jpeg|gif)/,".webp")),i.dataset.rawheight&&!i.getAttribute("height")&&i.setAttribute("height",i.dataset.rawheight),i.src=c,i.complete){i.dataset.lazyStatus="ok",null==o||o();return}e&&i.addEventListener("loadstart",function(){e("loadstart",c)}),i.dataset.lazyStatus="loading";var l=setTimeout(function(){i.complete||ep(i.url,"image_web_timeout_image"),e&&e("timeout",c)},15e3);i.addEventListener("load",function(){i.dataset.lazyStatus="ok",clearTimeout(l),ep(i.url,"image_web_success_image"),e&&e("load",c),null==o||o()}),i.addEventListener("error",function(){clearTimeout(l),ep(i.url,"image_web_fail_image"),e&&e("error",c)})}},eA=function(t){var e=t.node,o=t.useWebP,n=t.onLoadStateChange,r=t.size,a=t.quality,i=t.index,c=e.classList.contains("lazy"),l=ed("lossless"),u=(0,s._)((0,y.Z)({once:!0,rootMargin:"600px"}),3),d=u[0],f=u[1],h=u[2],p=(0,s._)((0,w.Z)(!c),2),v=p[0],A=p[1],x=(0,k.Z)(A.on),B=(0,k.Z)(ev({onLoadStateChange:n,onImageLoaded:x,enableWebP:l&&(void 0===o||o),size:r,quality:a}));(0,g.useEffect)(function(){f&&B(h)},[h,f,B]);var L=(0,g.useMemo)(function(){return{elementLocation:{type:"Image",moduleId:"image_card",moduleIndex:i}}},[i]),_=(0,b.x3)(L),z=(0,C.Z)(v?_:void 0,c?d:void 0),G=(0,b.Q4)().trackEvent,S=(0,k.Z)(function(){return v&&G(L)});return(0,m.tZ)(eh,{node:e,ref:z,onClick:S})},eb=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.useWebP,n=e.disabled,r=void 0!==n&&n,a=e.onLoadStateChange,i=e.size,c=e.quality,l=(0,s._)((0,g.useState)([]),2),u=l[0],d=l[1];ei(u,ev({onLoadStateChange:a,enableWebP:ed("lossless")&&(void 0===o||o),size:i,quality:c}),{rootMargin:"300px"}),(0,g.useEffect)(function(){if(t&&!r){var e=Array.from(t.querySelectorAll("img.lazy:not([data-thumbnail])"));e.length&&d(e)}},[t,r])},ek=function(t){return eb(t.root,t.options),null},ey=function(t,e){A.Z.trackEvent(t,{action:"StatusReport",element:"Card"},{status:{result:e}})},ew=function(t,e){var o,n;null==window||null===(o=window.Raven)||void 0===o||null===(n=o.captureException)||void 0===n||n.call(o,t,{fingerprint:["gif2mp4"],extra:e})},eC=function(t){var e=t.src,o=t.useWebP,n=void 0===o?"auto":o,r=t.useMp4,a=void 0!==r&&r,i=t.onRef,l=t.onLoadStateChange,d=t.onPlayChange,f=(0,u._)(t,["src","useWebP","useMp4","onRef","onLoadStateChange","onPlayChange"]),h=(0,s._)((0,g.useState)(""),2),p=h[0],b=h[1],k=(0,s._)((0,g.useState)(null),2),y=k[0],w=k[1],C=(0,s._)((0,g.useState)(Date.now()),2),B=C[0],L=C[1],_=(0,s._)((0,g.useState)(!1),2),z=_[0],G=_[1],S=(0,s._)((0,g.useState)(null),2),Z=S[0],R=S[1],I=ed("animation"),E=(0,g.useCallback)(function(){var t=((0,X.imgPathParse)(e)||{}).hash;a&&(0,O.y3)(y,function(){fetch("https://api.zhihu.com/gif2mp4/".concat(t),{credentials:"include",headers:{"X-Requested-With":"Fetch"}}).then(function(t){return t.json()}).then(function(t){var e,o,n=t.playlist,r=(null==n?void 0:null===(e=n.SD)||void 0===e?void 0:e.play_url)||(null==n?void 0:null===(o=n.LD)||void 0===o?void 0:o.play_url);r&&Y.ZP.increment("Gif2Mp4Player.mp4.fetch.success.count"),b(r)}).catch(v())})},[y,e,a]);(0,g.useEffect)(E,[e,a,y]),(0,g.useEffect)(function(){y&&A.Z.setModule(y,{module:"GifItem"})},[y]),ei(y,function(){A.Z.trackCardShow(y,{element:"Card"})}),(0,x.Z)(function(){Y.ZP.increment("Gif2Mp4Player.mp4.play.failure.count"),ew(Error("Gif2Mp4 play timeout"),{src:e,videoUrl:p}),G(!1)},z?2e3:null),(0,x.Z)(function(){Y.ZP.increment("Gif2Mp4Player.mp4.play.success.count"),Y.ZP.timing("Gif2Mp4Player.mp4.first_frame_time",Date.now()-B-100),G(!1),R(null)},Z);var T=(0,X.default)(e,{extension:("auto"===n?I:n)?"webp":"gif"});return(0,m.tZ)($.ZP,(0,c._)({videoUrl:p,src:T,onRef:(0,g.useCallback)(te(i,w),[]),onPlayChange:function(t){null==d||d(t),t||(L(Date.now()),p&&(Y.ZP.increment("Gif2Mp4Player.mp4.click.count"),G(!0)),A.Z.trackEvent(y,{action:"Click",element:"Image"}))},onLoadStart:function(){if(p){var t=J.parse(p).expiration;t&&Number(t)<Date.now()/1e3+900&&E()}L(Date.now()),l&&l("loadstart",T)},onSuccess:function(){ey(y,"Success"),p?z&&R(100):Y.ZP.timing("Gif2Mp4Player.gif.first_frame_time",Date.now()-B),l&&l("load",T)},onFailed:function(t){ey(y,"Fail"),p&&(z&&(Y.ZP.increment("Gif2Mp4Player.mp4.play.failure.count"),G(!1),R(null)),ew(t,{videoUrl:p,src:e})),l&&l("error",T)}},f))},ex=function(t){var e=t.dataset,o=e.thumbnail,n=e.size,r=e.rawheight;return{src:o,poster:o,size:n,width:e.rawwidth,height:r}},eB=function(t){var e=t.node,o=t.Component,n=void 0===o?eC:o,r=(0,g.useMemo)(function(){return ex(e)},[e]);return(0,m.tZ)(n,(0,c._)({},r))},eL=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.Component,n=void 0===o?eC:o,r=(0,s._)((0,g.useState)(null),2),a=r[0],i=r[1];return(0,g.useEffect)(function(){if(t){var e=Array.from(t.querySelectorAll("img.origin_image[data-thumbnail],img.content_image[data-thumbnail]"));e.length&&i(e.map(function(t,e){var o=document.createElement("div");return o.className="RichText-gifPlaceholder",t.parentNode.replaceChild(o,t),(0,H.createPortal)((0,m.tZ)(eB,{node:t,Component:n},e),o)}))}},[t]),a},e_=function(t){return eL(t.root,t.options)},ez=function(t){var e=t.root,o=t.ConditionalImage,n=(0,s._)((0,g.useState)([]),2),r=n[0],a=n[1];return(0,g.useEffect)(function(){if(e){var t=Array.from(e.querySelectorAll("img.origin_image,img.content_image"));t.length&&a(t.map(function(t,e){var n=document.createElement("div");return t.parentNode.replaceChild(n,t),(0,H.createPortal)((0,m.tZ)(o,{index:e,node:t},e),n)}))}},[e]),r},eG=to([function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).linkCardInfo;return t?t.replace(tU,function(t,o){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=tD(o,{decodeValue:!0}),a=r.target,i=r.href,l=void 0===i?"":i,u=r["data-image"],s=r["data-image-width"],d=r["data-image-height"],f=r["data-entity-type"],h=r["data-entity-data"],g=r["data-size"];if(r["data-is-ecommerce"])return t;var p=n.replace(/<[^>]*>/g,"");p=tK(p),l.match(/https:\/\/www.zhihu.com\/zvideo\/(\d+)$/)&&!p&&(p="知乎视频");var v=e?tW:tC;return(0,S.renderToStaticMarkup)((0,m.tZ)(v,(0,c._)({text:p,url:l,target:void 0===a?"_blank":a,image:u,imageWidth:s,imageHeight:d,entityType:f,entityData:tN(h),size:g},e&&{data:e[l]})))}):t},function(t){return t?t.replace(tH,function(t,e){var o=tD(e,{decodeValue:!0}),n=o["data-draft-type"],r=o.href,a=o.class;return"link-card"!==n?t:(0,S.renderToStaticMarkup)((0,m.tZ)(tO,{url:r,className:M()(a,{old:!0,new:!1,static:!1})}))}):t}]),eS=(0,g.forwardRef)(function(t,e){var o=(0,s._)((0,g.useState)(null),2),n=o[0],r=o[1],a=t.html,i=t.css,l=t.options,d=void 0===l?{}:l,f=t.ConditionalImage,h=t.linkCardInfo,p=(0,u._)(t,["html","css","options","ConditionalImage","linkCardInfo"]),v=d.lazyLoadImageOptions,A=d.useGifPortalOption,b=(0,u._)(d,["lazyLoadImageOptions","useGifPortalOption"]);ta(n);var k=[er,ea,i].reduce(function(t,e){return(e||(e={}),"function"==typeof e)?function(o){return(0,c._)({},t(o),e(o))}:function(o){return(0,c._)({},t(o),e)}},function(t){return{}}),y=(0,g.useCallback)(te(e,r),[]);return(0,m.BX)(g.Fragment,{children:[!h&&(0,m.tZ)(et,{css:ea,root:n}),f?(0,m.tZ)(ez,{root:n,ConditionalImage:f}):(0,m.BX)(m.HY,{children:[(0,m.tZ)(ek,{root:n,options:v}),(0,m.tZ)(e_,{root:n,options:A})]}),(0,m.tZ)(ts,{root:n}),(0,m.tZ)(ty,(0,c._)({ref:y,html:eG(a,{linkCardInfo:h}),css:k,root:n,options:b},p))]})}),eZ=/<sup\b([^>]*data-draft-type="reference"[^>]*)>(.*?)<\/sup>/g}}]);
//# sourceMappingURL=lib-0e5ce61e.app.f3d2757e874ba03c7c9f.js.map