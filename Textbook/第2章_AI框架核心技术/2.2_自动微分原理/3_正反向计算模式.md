<!--é€‚ç”¨äº[License](https://github.com/chenzomi12/DeepLearningSystem/blob/main/LICENSE)ç‰ˆæƒè®¸å¯-->

# æ­£åå‘è®¡ç®—æ¨¡å¼

ä¸Šä¸€èŠ‚ç®€å•äº†è§£äº†è®¡ç®—æœºä¸­å¸¸ç”¨çš„å‡ ç§å¾®åˆ†æ–¹å¼ã€‚

æœ¬ç« å°†æ·±å…¥ä»‹ç»AIæ¡†æ¶ç¦»ä¸å¼€çš„æ ¸å¿ƒåŠŸèƒ½è‡ªåŠ¨å¾®åˆ†ï¼Œè€Œè‡ªåŠ¨å¾®åˆ†åˆ™æ˜¯åˆ†ä¸ºå‰å‘å¾®åˆ†å’Œåå‘å¾®åˆ†ä¸¤ç§å®ç°æ¨¡å¼ï¼Œä¸åŒçš„å®ç°æ¨¡å¼æœ‰ä¸åŒçš„æœºåˆ¶å’Œè®¡ç®—é€»è¾‘ï¼Œè€Œæ— è®ºå“ªç§æ¨¡å¼éƒ½ç¦»ä¸å¼€é›…å…‹æ¯”çŸ©é˜µï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿä¼šæ·±å…¥äº†è§£ä¸€ä¸‹é›…å…‹æ¯”çŸ©é˜µçš„åŸç†ã€‚

## é›…å…‹æ¯”çŸ©é˜µ

åœ¨å‘é‡å¾®ç§¯åˆ†ä¸­ï¼ŒJacobiançŸ©é˜µæ˜¯ä¸€é˜¶åå¯¼æ•°ä»¥ä¸€å®šæ–¹å¼æ’åˆ—æˆçš„çŸ©é˜µï¼Œå…¶è¡Œåˆ—å¼ç§°ä¸ºJacobianè¡Œåˆ—å¼ã€‚JacobiançŸ©é˜µçš„é‡è¦æ€§åœ¨äºå®ƒä½“ç°äº†ä¸€ä¸ªå¯å¾®æ–¹ç¨‹ä¸ç»™å‡ºç‚¹çš„æœ€ä¼˜çº¿æ€§é€¼è¿‘ã€‚

Jacobian çŸ©é˜µè¡¨ç¤ºä¸¤ä¸ªå‘é‡æ‰€æœ‰å¯èƒ½çš„åå¯¼æ•°ã€‚å®ƒæ˜¯ä¸€ä¸ªå‘é‡ç›¸å¯¹äºå¦ä¸€ä¸ªå‘é‡çš„æ¢¯åº¦ï¼Œå…¶å®ç°çš„æ˜¯ $n$ ç»´å‘é‡åˆ° $m$ ç»´å‘é‡çš„æ˜ å°„ã€‚

åœ¨çŸ¢é‡è¿ç®—ä¸­ï¼ŒJacobian çŸ©é˜µæ˜¯åŸºäºå‡½æ•°å¯¹æ‰€æœ‰å˜é‡ä¸€é˜¶åå¯¼æ•°çš„æ•°å€¼çŸ©é˜µï¼Œå½“è¾“å…¥ä¸ªæ•°ç­‰äºè¾“å‡ºä¸ªæ•°æ—¶åˆç§°ä¸ºJacobianè¡Œåˆ—å¼ã€‚

å‡è®¾è¾“å…¥å‘é‡ $ğ‘¥âˆˆğ‘…_ğ‘›$ï¼Œè€Œè¾“å‡ºå‘é‡ $ğ‘¦âˆˆğ‘…_ğ‘š$ï¼Œåˆ™ Jacobian çŸ©é˜µå®šä¹‰ä¸ºï¼š

$$
J_f=
\left[
 \begin{matrix}
   \dfrac{\delta y_1}{\delta x_1} & \cdots & \dfrac{\delta y_1}{\delta x_n} \\
   \vdots & \ddots & \vdots \\
   \dfrac{\delta y_m}{\delta x_1} & \vdots & \dfrac{\delta y_m}{\delta x_n}
  \end{matrix}
  \right]
\tag{1}
$$

## **å¾®åˆ†è®¡ç®—æ¨¡å¼**

æ ¹æ®å¯¹åˆ†è§£åçš„åŸºæœ¬æ“ä½œæ±‚å¯¼å’Œé“¾å¼è§„åˆ™ç»„åˆé¡ºåºçš„ä¸åŒï¼Œè‡ªåŠ¨å¾®åˆ†å¯ä»¥åˆ†ä¸ºä¸¤ç§æ¨¡å¼ï¼š

- *å‰å‘æ¨¡å¼*ï¼ˆForward Automatic Differentiationï¼Œä¹Ÿå«åš tangent mode ADï¼‰æˆ–è€…å‰å‘ç´¯ç§¯æ¢¯åº¦ï¼ˆå‰å‘æ¨¡å¼ï¼‰
- *åå‘æ¨¡å¼*ï¼ˆReverse Automatic Differentiationï¼Œä¹Ÿå«åš adjoint mode ADï¼‰æˆ–è€…è¯´åå‘ç´¯è®¡æ¢¯åº¦ï¼ˆåå‘æ¨¡å¼ï¼‰ã€‚

### è®¡ç®—æ¨¡å¼åŒºåˆ«

ä¸¤ç§è‡ªåŠ¨å¾®åˆ†æ¨¡å¼éƒ½é€šè¿‡é€’å½’æ–¹å¼æ¥æ±‚ $dy/dx$ï¼Œåªä¸è¿‡æ ¹æ®é“¾å¼æ³•åˆ™å±•å¼€çš„å½¢å¼ä¸å¤ªä¸€æ ·ã€‚

å‰å‘æ¢¯åº¦ç´¯ç§¯ä¼šæŒ‡å®šä»å†…åˆ°å¤–çš„é“¾å¼æ³•åˆ™éå†è·¯å¾„ï¼Œå³å…ˆè®¡ç®— $dw_1/dx$ï¼Œå†è®¡ç®— $dw_2/dw_1$ï¼Œæœ€åè®¡ç®— $dy/dw_2$ã€‚å³ï¼Œå‰å‘æ¨¡å¼æ˜¯åœ¨è®¡ç®—å›¾å‰å‘ä¼ æ’­çš„åŒæ—¶è®¡ç®—å¾®åˆ†ã€‚å› æ­¤å‰å‘æ¨¡å¼çš„ä¸€æ¬¡æ­£å‘ä¼ æ’­å°±å¯ä»¥è®¡ç®—å‡ºè¾“å‡ºå€¼å’Œå¯¼æ•°å€¼ã€‚

$$
\frac{dw_i}{dx}=\frac{dw_i}{dw_{i-1}}\frac{dw_{i-1}}{dx}
\tag{2}
$$

åå‘æ¢¯åº¦ç´¯ç§¯æ­£å¥½ç›¸åï¼Œå®ƒä¼šå…ˆè®¡ç®— $dy/dw_2$ï¼Œç„¶åè®¡ç®— $dw_2/dw_1$ï¼Œæœ€åè®¡ç®— $dw_1/dx$ã€‚è¿™æ˜¯æœ€ä¸ºç†Ÿæ‚‰çš„åå‘ä¼ æ’­æ¨¡å¼ï¼Œå®ƒéå¸¸ç¬¦åˆ**æ²¿æ¨¡å‹è¯¯å·®åå‘ä¼ æ’­**è¿™ä¸€ç›´è§‚æ€è·¯ã€‚

å³ï¼Œåå‘æ¨¡å¼éœ€è¦å¯¹è®¡ç®—å›¾è¿›è¡Œä¸€æ¬¡æ­£å‘è®¡ç®—ï¼Œ å¾—å‡ºè¾“å‡ºå€¼ï¼Œå†è¿›è¡Œåå‘ä¼ æ’­ã€‚åå‘æ¨¡å¼éœ€è¦ä¿å­˜æ­£å‘ä¼ æ’­çš„ä¸­é—´å˜é‡å€¼ï¼ˆæ¯”å¦‚$ğ‘¤_ğ‘–$ï¼‰ï¼Œè¿™äº›ä¸­é—´å˜é‡æ•°å€¼åœ¨åå‘ä¼ æ’­æ—¶å€™è¢«ç”¨æ¥è®¡ç®—å¯¼æ•°ï¼Œæ‰€ä»¥åå‘æ¨¡å¼çš„å†…å­˜å¼€é”€è¦å¤§ã€‚

$$
\frac{dy}{dw_i}=\frac{dy}{dw_{i+1}}\frac{dw_{i+1}}{dw_i}
\tag{3}
$$

å³å¦‚å›¾æ‰€ç¤ºï¼Œå‰å‘è‡ªåŠ¨å¾®åˆ†ï¼ˆtangent mode ADï¼‰å’Œåå‘è‡ªåŠ¨å¾®åˆ†ï¼ˆadjoint mode ADï¼‰åˆ†åˆ«è®¡ç®—äº†JacobiançŸ©é˜µçš„ä¸€åˆ—å’Œä¸€è¡Œã€‚

![](../../../Frontend/02_AutoDiff/images/tangent_adjoint.png)

å‰å‘è‡ªåŠ¨å¾®åˆ†ï¼ˆtangent mode ADï¼‰å¯ä»¥åœ¨ä¸€æ¬¡ç¨‹åºè®¡ç®—ä¸­é€šè¿‡é“¾å¼æ³•åˆ™ï¼Œå¾—åˆ°ï¼š

$$
\frac{\delta x^k}{\delta x^0_j}=
\frac{\delta x^k}{\delta x^{k-1}}
\frac{\delta ^{k-1}}{\delta x^0_j}
\tag{4}
$$

é€’æ¨å¾—åˆ° Jacobian çŸ©é˜µä¸­ä¸å•ä¸ªè¾“å…¥æœ‰å…³çš„å‚æ•°ï¼Œå³ JacobiançŸ© é˜µçš„ä¸€åˆ—ã€‚

åå‘è‡ªåŠ¨å¾®åˆ†ï¼ˆadjoint mode ADï¼‰åˆ©ç”¨é“¾å¼æ³•åˆ™ï¼Œå¾—åˆ°ï¼š

$$
\frac{\delta x^L_i}{\delta x^k}=
\frac{\delta x^L_i}{\delta x^{k+1}}
\frac{\delta ^{k+1}}{\delta x^k}
\tag{5}
$$

å¯ä»¥ä»…é€šè¿‡ä¸€æ¬¡å¯¹è®¡ç®—è¿‡ç¨‹çš„éå†å¾—åˆ°JacobiançŸ©é˜µçš„ä¸€è¡Œã€‚ä½†å®ƒçš„å¯¼æ•°é“¾å¼æ³•åˆ™ä¼ é€’æ–¹å‘å’Œç¨‹åºæ‰§è¡Œæ–¹å‘ç›¸åï¼Œæ‰€ä»¥éœ€è¦åœ¨ç¨‹åºè®¡ç®—è¿‡ç¨‹ä¸­è®°å½•ä¸€äº›é¢å¤–çš„ä¿¡æ¯æ¥è¾…åŠ©æ±‚å¯¼ï¼Œè¿™äº›è¾…åŠ©ä¿¡æ¯åŒ…æ‹¬è®¡ç®—å›¾å’Œè®¡ç®—è¿‡ç¨‹çš„ä¸­é—´å˜é‡ã€‚

### æ ·ä¾‹

æˆ‘ä»¬ä»¥å…¬å¼ä¸ºä¾‹ï¼Œé¦–å…ˆæŠŠå®ƒè½¬æ¢æˆä¸€ä¸ªè®¡ç®—å›¾ï¼š

$$
f(x1,x2)=ln(x1)+x1x2âˆ’sin(x2)
\tag{5}
$$

- è¾“å…¥å˜é‡ ï¼šè‡ªå˜é‡ç»´åº¦ä¸º $n$ï¼Œè¿™é‡Œ $n = 2$ï¼Œè¾“å…¥å˜é‡å°±æ˜¯Â $x1$, $x2$
- ä¸­é—´å˜é‡ ï¼šä¸­é—´å˜é‡è¿™é‡Œæ˜¯Â $v-1 $åˆ°Â $v5$ï¼Œåœ¨è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œåªéœ€è¦é’ˆå¯¹è¿™äº›ä¸­é—´å˜é‡åšå¤„ç†å³å¯ã€‚å°†ç¬¦å·å¾®åˆ†æ³•åº”ç”¨äºæœ€åŸºæœ¬çš„ç®—å­ï¼Œç„¶åä»£å…¥æ•°å€¼ï¼Œä¿ç•™ä¸­é—´ç»“æœï¼Œæœ€åå†åº”ç”¨äºæ•´ä¸ªå‡½æ•°
- è¾“å‡ºå˜é‡ ï¼šå‡è®¾è¾“å‡ºå˜é‡ç»´åº¦ä¸º $m$ï¼Œè¿™é‡Œ $m = 1$ï¼Œè¾“å‡ºå˜é‡å°±æ˜¯Â $y1$ï¼Œä¹Ÿå°±æ˜¯ $f(x1,x2)$

![](../../../Frontend/02_AutoDiff/images/forward_mode.png)

è½¬åŒ–æˆå¦‚ä¸Š DAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰ç»“æ„ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åˆ†æ­¥è®¡ç®—å‡½æ•°çš„å€¼ï¼Œå¹¶æ±‚å–å®ƒæ¯ä¸€æ­¥çš„å¯¼æ•°å€¼ï¼Œç„¶åï¼Œæˆ‘ä»¬æŠŠ $df/dx_1$ æ±‚å¯¼è¿‡ç¨‹åˆ©ç”¨é“¾å¼æ³•åˆ™è¡¨ç¤ºæˆå¦‚ä¸‹çš„å½¢å¼ï¼š

$$
\dfrac{df}{dx_1}=
\dfrac{dv_{-1}}{dx_1} \cdot
(\dfrac{dv_{1}}{dv_{-1}} \cdot \dfrac{dv_{4}}{dv_{1}} +
\dfrac{dv_{2}}{dv_{-1}} \cdot \dfrac{dv_{4}}{dx_{2}}) \cdot
\dfrac{dv_{5}}{dv_{4}} \cdot \dfrac{df}{dv_{5}}
\tag{6}
$$

> æ•´ä¸ªæ±‚å¯¼å¯ä»¥è¢«æ‹†æˆä¸€ç³»åˆ—å¾®åˆ†ç®—å­çš„ç»„åˆã€‚

## å‰å‘æ¨¡å¼ Foward Mode

å‰å‘æ¨¡å¼ä»è®¡ç®—å›¾çš„èµ·ç‚¹å¼€å§‹ï¼Œæ²¿ç€è®¡ç®—å›¾è¾¹çš„æ–¹å‘ä¾æ¬¡å‘å‰è®¡ç®—ï¼Œæœ€ç»ˆåˆ°è¾¾è®¡ç®—å›¾çš„ç»ˆç‚¹ã€‚å®ƒæ ¹æ®è‡ªå˜é‡çš„å€¼è®¡ç®—å‡ºè®¡ç®—å›¾ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å€¼ ä»¥åŠå…¶å¯¼æ•°å€¼ï¼Œå¹¶ä¿ç•™ä¸­é—´ç»“æœã€‚ä¸€ç›´å¾—åˆ°æ•´ä¸ªå‡½æ•°çš„å€¼å’Œå…¶å¯¼æ•°å€¼ã€‚æ•´ä¸ªè¿‡ç¨‹å¯¹åº”äºä¸€å…ƒå¤åˆå‡½æ•°æ±‚å¯¼æ—¶ä»æœ€å†…å±‚é€æ­¥å‘å¤–å±‚æ±‚å¯¼ã€‚

åŒæ ·ï¼Œä»¥å…¬å¼ä¸ºä¾‹å­ï¼š

$$
f(x1,x2)=ln(x1)+x1x2âˆ’sin(x2)
\tag{7}
$$

é¢æ˜¯å‰å‘æ¨¡å¼çš„è®¡ç®—è¿‡ç¨‹ï¼Œä¸‹è¡¨ä¸­ï¼Œå·¦åŠéƒ¨åˆ†æ˜¯ä»å·¦å¾€å³æ¯ä¸ªå›¾èŠ‚ç‚¹çš„æ±‚å€¼ç»“æœå’Œè®¡ç®—è¿‡ç¨‹ï¼Œå³åŠéƒ¨åˆ†æ˜¯æ¯ä¸ªèŠ‚ç‚¹å¯¹ x1çš„æ±‚å¯¼ç»“æœå’Œè®¡ç®—è¿‡ç¨‹ã€‚è¿™é‡Œ $ğ‘‰Ë™ğ‘–$ è¡¨ç¤º $ğ‘‰ğ‘–$ å¯¹ $ğ‘¥1$ çš„åå¯¼æ•°ã€‚å³ï¼š

$$
\dot{v_i}=\dfrac{\delta v_i}{\delta x_1}
\tag{8}
$$

åœ¨è¯¥ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›è®¡ç®—å‡½æ•°åœ¨x_1=2, x_2=5å¤„çš„å¯¼æ•°dy/dx1ï¼Œå³ï¼š

$$
\dot{y_j}=\dfrac{\delta y_j}{\delta x_i}
\tag{9}
$$

å¯ä»¥çœ‹å‡ºï¼Œå·¦ä¾§æ˜¯æºç¨‹åºåˆ†è§£åå¾—åˆ°çš„åŸºæœ¬æ“ä½œé›†åˆï¼Œè€Œå³ä¾§åˆ™æ˜¯æ¯ä¸€ä¸ªåŸºæœ¬æ“ä½œæ ¹æ®å·²çŸ¥çš„æ±‚å¯¼è§„åˆ™å’Œé“¾å¼æ³•åˆ™ç”±ä¸Šè‡³ä¸‹è®¡ç®—çš„æ±‚å¯¼ç»“æœã€‚

![](../../../Frontend/02_AutoDiff/images/ad/autodiff04.png)

### è®¡ç®—è¿‡ç¨‹

æ ¹æ®ä¸Šå›¾å·¦è¾¹çš„Forward Primal Traceç›´æ¥è®¡ç®—å…¬å¼ï¼Œå¯¹äºèŠ‚ç‚¹æ•°å€¼çš„è®¡ç®—å¦‚ä¸‹ï¼š

1. æˆ‘ä»¬ç»™è¾“å…¥èŠ‚ç‚¹èµ‹å€¼ï¼Œ$v_{âˆ’1}=x_1=2ï¼Œv_0=x_2=5$
2. è®¡ç®— $v_1$ èŠ‚ç‚¹ï¼Œ$v_1=lnv_{âˆ’1}=lnx_1=ln2$
3. è®¡ç®—Â $v_2$Â èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹ $v_2$ ä¾èµ–äº $v_{-1}$Â å’ŒÂ $v_0$ï¼Œ$v_2=10$
4. è®¡ç®— $v_3$ èŠ‚ç‚¹ï¼Œ$v_3=sinv_0=sin5$
5. è®¡ç®— $v_4$ èŠ‚ç‚¹ï¼Œ$v_4=v_1+v_2=0.693+10$
6. è®¡ç®— $v_5$ èŠ‚ç‚¹ï¼Œ$v_5=v_1+v_2=10.693+0.959$
7. æœ€ç»ˆ $y=v_5=11.652$

æ­¤æ—¶ï¼Œå·²ç»å¾—åˆ°äº†å›¾ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„æ•°å€¼ã€‚è‡ªåŠ¨å¾®åˆ†æ­£å‘æ¨¡å¼ä¸­ï¼ˆä¸Šå›¾å³è¾¹Forward Tangent Traceï¼‰ï¼Œåœ¨è®¡ç®—èŠ‚ç‚¹æ•°å€¼çš„åŒæ—¶ï¼Œä¹Ÿä¸€èµ·è®¡ç®—å¯¼æ•°ï¼Œå‡è®¾æ±‚ $\delta y/ \delta x_1$ï¼Œåˆ™æ˜¯ä»è¾“å…¥å¼€å§‹è®¡ç®—ã€‚

1. è®¡ç®— $v_{-1}$ èŠ‚ç‚¹å¯¹äº $x_1$ çš„æ¢¯åº¦ï¼š$v_{-1}=x_1$ï¼Œæ‰€ä»¥ $\delta v_{-1}/ \delta x_1=1$
2. è®¡ç®— $v_0$ èŠ‚ç‚¹å¯¹äº $x_1$ çš„æ¢¯åº¦ï¼š$v_0=x_2$ï¼Œæ‰€ä»¥ $\delta v_0/ \delta x_1=0$
3. è®¡ç®— $v_{1}$ èŠ‚ç‚¹å¯¹äº $x_1$ çš„æ¢¯åº¦ï¼š$\delta v_1/ \delta x_1=0.5$
4. è®¡ç®— $v_{2}$ èŠ‚ç‚¹å¯¹äº $x_1$ çš„æ¢¯åº¦ï¼š$\delta v_{2}/ \delta x_1=(\delta v_{-1}/ \delta x_1)v_0+(\delta v_{0}/ \delta x_1)v_{-1}=5$
5. è®¡ç®— $v_{3}$ èŠ‚ç‚¹å¯¹äº $x_1$ çš„æ¢¯åº¦ï¼š$\delta v_{3}/ \delta x_1=(\delta v_{0}/ \delta x_1)cosv_0=0$
6. è®¡ç®— $v_{4}$ èŠ‚ç‚¹å¯¹äº $x_1$ çš„æ¢¯åº¦ï¼š$\delta v_{4}/ \delta x_1=\delta v_{1}/ \delta x_1+\delta v_{2}/ \delta x_1=0.5+5$
7. è®¡ç®— $v_{5}$ èŠ‚ç‚¹å¯¹äº $x_1$ çš„æ¢¯åº¦ï¼š$\delta v_{5}/ \delta x_1=5.5=0$
8. å› æ­¤ï¼Œå¾—åˆ° $\delta y/ \delta x_1=\delta v_{5}/ \delta x_1=5.5$

ä»è®¡ç®—è¿‡ç¨‹æ¥çœ‹å•¦ï¼Œè‡ªåŠ¨å¾®åˆ†çš„å‰å‘æ¨¡å¼å®é™…ä¸Šä¸æˆ‘ä»¬åœ¨å¾®ç§¯åˆ†é‡Œæ‰€å­¦çš„æ±‚å¯¼è¿‡ç¨‹ä¸€è‡´ã€‚

### é›…å…‹æ¯”-å‘é‡çŸ©é˜µ

æŠŠä¸Šè¿°è¿‡ç¨‹å½“åšé›…å…‹æ¯”çŸ©é˜µæ±‚è§£é—®é¢˜ï¼Œå‡è®¾ä¸€ä¸ªå‡½æ•°æœ‰ n ä¸ªè¾“å…¥å˜é‡ $x_i$ï¼Œmä¸ªè¾“å…¥å˜é‡ $y_j$ï¼Œå³è¾“å…¥å‘é‡ $x \in R^n, y \in R^m$ï¼Œåˆ™è¿™ä¸ªçš„æ˜ å°„æ˜¯ï¼š

$$
f:R^n \to R^m \tag{10}
$$

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªè‡ªåŠ¨å¾®åˆ†çš„å‰å‘ä¼ æ’­è®¡ç®—æ—¶å€™ï¼Œåˆå§‹è¾“å…¥è¢«è®¾ç½®ä¸º $\dot{x_i}=1$ï¼Œå…¶ä½™è¢«è®¾ç½®ä¸º 0ã€‚å¯¹åº”JacobiançŸ©é˜µå®šä¹‰ä¸ºï¼š

$$
J_f=
\left[
 \begin{matrix}
   \dfrac{\delta y_1}{\delta x_1} & \cdots & \dfrac{\delta y_1}{\delta x_n} \\
   \vdots & \ddots & \vdots \\
   \dfrac{\delta y_m}{\delta x_1} & \vdots & \dfrac{\delta y_m}{\delta x_n}
  \end{matrix}
  \right]
\tag{11}
$$

ä¸€æ¬¡å‰å‘è®¡ç®—ï¼Œå¯ä»¥æ±‚å‡ºJacobiançŸ©é˜µçš„ä¸€åˆ—æ•°æ®ï¼Œå¦‚ $\dot{x_3}=1$ å¯¹åº”å°±å¯ä»¥æ±‚å‡ºæ¥ç¬¬3åˆ—ã€‚tangent mode ADå¯ä»¥åœ¨ä¸€æ¬¡ç¨‹åºè®¡ç®—ä¸­ï¼Œé€šè¿‡é“¾å¼æ³•åˆ™é€’æ¨å¾—åˆ°JacobiançŸ©é˜µä¸­ä¸å•ä¸ªè¾“å…¥æœ‰å…³çš„éƒ¨åˆ†ï¼Œå³JacobiançŸ©é˜µçš„ä¸€åˆ—ã€‚

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¦‚æœæƒ³ç”¨æ­£å‘æ¨¡å¼æ±‚å¯¹æ‰€æœ‰è¾“å…¥çš„å¯¼æ•°ï¼Œéœ€è¦è®¡ç®— n æ¬¡æ‰èƒ½æ±‚å‡ºæ‰€æœ‰åˆ—ã€‚

![](../../../Frontend/02_AutoDiff/images/tangent_adjoint.png)

è¿›ä¸€æ­¥ï¼Œè®¾ç½® $\dot{x}=r$ï¼Œå¯ä»¥åœ¨ä¸€æ¬¡å‰å‘ä¼ æ’­ä¸­ç›´æ¥è®¡ç®— Jacobianâ€“vector ä¹˜ç§¯ï¼š

$$
J_f \cdot r=
\left[
 \begin{matrix}
   \dfrac{\delta y_1}{\delta x_1} & \cdots & \dfrac{\delta y_1}{\delta x_n} \\
   \vdots & \ddots & \vdots \\
   \dfrac{\delta y_m}{\delta x_1} & \vdots & \dfrac{\delta y_m}{\delta x_n}
  \end{matrix}
  \right]
\left[
\begin{matrix}
    r_1 \\
    \vdots \\
     r_n \\
  \end{matrix}
  \right]
\tag{12}
$$

æœ€ç»ˆæˆ‘ä»¬å¯ä»¥é€’å½’çš„å¾—åˆ°æœ¬æ¬¡è¿­ä»£çš„è®¡ç®—ç›®æ ‡ï¼šé›…å…‹æ¯”çŸ©é˜µä¸­çš„ç¬¬Â i è¡Œã€‚

### ä¼˜ç¼ºç‚¹

å‰å‘æ¨¡å¼çš„ä¼˜ç‚¹ï¼š

- å®ç°èµ·æ¥å¾ˆç®€å•
- ä¹Ÿä¸éœ€è¦å¾ˆå¤šé¢å¤–çš„å†…å­˜ç©ºé—´

å‘å‰æ¨¡å¼çš„ç¼ºç‚¹ï¼š

- æ¯æ¬¡å‰å‘è®¡ç®—åªèƒ½è®¡ç®—å¯¹ä¸€ä¸ªè‡ªå˜é‡çš„åå¯¼æ•°ï¼Œå¯¹äºä¸€å…ƒå‡½æ•°æ±‚å¯¼æ˜¯é«˜æ•ˆçš„ï¼Œä½†æ˜¯æœºå™¨å­¦ä¹ æ¨¡å‹çš„è‡ªå‚æ•°ï¼ˆå…¥å‚ï¼‰æ•°é‡çº§å¤§ã€‚
- å¦‚æœæœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå…¶è¾“å…¥æœ‰ n ä¸ªï¼Œè¾“å‡ºæœ‰ mä¸ªï¼Œå¯¹äºæ¯ä¸ªè¾“å…¥æ¥è¯´ï¼Œå‰å‘æ¨¡å¼éƒ½éœ€è¦éå†è®¡ç®—è¿‡ç¨‹ä»¥å¾—åˆ°å½“å‰è¾“å…¥çš„å¯¼æ•°ï¼Œæ±‚è§£æ•´ä¸ªå‡½æ•°æ¢¯åº¦éœ€è¦ n éå¦‚ä¸Šè®¡ç®—è¿‡ç¨‹ã€‚

## åå‘æ¨¡å¼ Reverse Mode

åå‘è‡ªåŠ¨å¾®åˆ†åŒæ ·æ˜¯åŸºäºé“¾å¼æ³•åˆ™ã€‚ä»…éœ€è¦ä¸€ä¸ªå‰å‘è¿‡ç¨‹å’Œåå‘è¿‡ç¨‹ï¼Œå°±å¯ä»¥è®¡ç®—æ‰€æœ‰å‚æ•°çš„å¯¼æ•°æˆ–è€…æ¢¯åº¦ã€‚

å› ä¸ºéœ€è¦ç»“åˆå‰å‘å’Œåå‘ä¸¤ä¸ªè¿‡ç¨‹ï¼Œå› æ­¤åå‘è‡ªåŠ¨å¾®åˆ†ä¼šä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„æ•°æ®ç»“æ„ï¼Œæ¥å­˜å‚¨è®¡ç®—è¿‡ç¨‹ã€‚

è€Œè¿™ä¸ªç‰¹æ®Šçš„æ•°æ®ç»“æ„ä¾‹å¦‚Tensorflowæˆ–è€…MindSporeï¼Œåˆ™æ˜¯æŠŠæ‰€æœ‰çš„æ“ä½œä»¥ä¸€å¼ å›¾çš„æ–¹å¼å­˜å‚¨ä¸‹æ¥ï¼Œè¿™å¼ å›¾å¯ä»¥æ˜¯ä¸€ä¸ªæœ‰å‘æ— ç¯ï¼ˆDAGï¼‰çš„è®¡ç®—å›¾ï¼›è€ŒPytrochåˆ™æ˜¯ä½¿ç”¨Tapeæ¥è®°å½•æ¯ä¸€ä¸ªæ“ä½œï¼Œä»–ä»¬éƒ½è¡¨è¾¾äº†å‡½æ•°å’Œå˜é‡çš„å…³ç³»ã€‚

åå‘æ¨¡å¼æ ¹æ®ä»åå‘å‰è®¡ç®—ï¼Œä¾æ¬¡å¾—åˆ°å¯¹æ¯ä¸ªä¸­é—´å˜é‡èŠ‚ç‚¹çš„åå¯¼æ•°ï¼Œç›´åˆ°åˆ°è¾¾è‡ªå˜é‡èŠ‚ç‚¹å¤„ï¼Œè¿™æ ·å°±å¾—åˆ°äº†æ¯ä¸ªè¾“å…¥çš„åå¯¼æ•°ã€‚åœ¨æ¯ä¸ªèŠ‚ç‚¹å¤„ï¼Œæ ¹æ®è¯¥èŠ‚ç‚¹çš„åç»­èŠ‚ç‚¹ï¼ˆå‰å‘ä¼ æ’­ä¸­çš„åç»­èŠ‚ç‚¹ï¼‰è®¡ç®—å…¶å¯¼æ•°å€¼ã€‚

æ•´ä¸ªè¿‡ç¨‹å¯¹åº”äºå¤šå…ƒå¤åˆå‡½æ•°æ±‚å¯¼æ—¶ä»æœ€å¤–å±‚é€æ­¥å‘å†…ä¾§æ±‚å¯¼ã€‚è¿™æ ·å¯ä»¥æœ‰æ•ˆåœ°æŠŠå„ä¸ªèŠ‚ç‚¹çš„æ¢¯åº¦è®¡ç®—è§£è€¦å¼€ï¼Œæ¯æ¬¡åªéœ€è¦å…³æ³¨è®¡ç®—å›¾ä¸­å½“å‰èŠ‚ç‚¹çš„æ¢¯åº¦è®¡ç®—ã€‚

ä»ä¸‹å›¾å¯ä»¥çœ‹å‡ºæ¥ï¼Œreverse modeå’Œforward modeæ˜¯ä¸€å¯¹ç›¸åè¿‡ç¨‹ï¼Œreverse modeä»æœ€ç»ˆç»“æœå¼€å§‹æ±‚å¯¼ï¼Œåˆ©ç”¨æœ€ç»ˆè¾“å‡ºå¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œæ±‚å¯¼ã€‚ä¸‹å›¾è™šçº¿å°±æ˜¯åå‘æ¨¡å¼ã€‚

![](../../../Frontend/02_AutoDiff/images/reversed_mode.png)

### è®¡ç®—è¿‡ç¨‹

å‰å‘å’Œåå‘ä¸¤ç§æ¨¡å¼çš„è¿‡ç¨‹è¡¨è¾¾å¦‚ä¸‹ï¼Œè¡¨çš„å·¦åˆ—æµ…è‰²ä¸ºå‰å‘è®¡ç®—å‡½æ•°å€¼çš„è¿‡ç¨‹ï¼Œä¸å‰å‘è®¡ç®—æ—¶ç›¸åŒï¼Œå³é¢åˆ—æ·±è‰²ä¸ºåå‘è®¡ç®—å¯¼æ•°å€¼çš„è¿‡ç¨‹ã€‚

åå‘æ¨¡å¼çš„è®¡ç®—è¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼Œå…¶ä¸­ï¼š

$$
\overline{v_i}=\dfrac{\delta y}{\delta v_i}
$$

æ ¹æ®é“¾å¼æ±‚å¯¼æ³•åˆ™å±•å¼€æœ‰ï¼š

$$
\frac{\partial f}{\partial x}=\sum_{k=1}^{N} \frac{\partial f}{\partial v_{k}} \frac{\partial v_{k}}{\partial \boldsymbol{x}}
$$

å¯ä»¥çœ‹å‡ºï¼Œå·¦ä¾§æ˜¯æºç¨‹åºåˆ†è§£åå¾—åˆ°çš„åŸºæœ¬æ“ä½œé›†åˆï¼Œè€Œå³ä¾§åˆ™æ˜¯æ¯ä¸€ä¸ªåŸºæœ¬æ“ä½œæ ¹æ®å·²çŸ¥çš„æ±‚å¯¼è§„åˆ™å’Œé“¾å¼æ³•åˆ™**ç”±ä¸‹è‡³ä¸Š**è®¡ç®—çš„æ±‚å¯¼ç»“æœã€‚

![](../../../Frontend/02_AutoDiff/images/autodiff04.png)

1. è®¡ç®— $y$ å¯¹ $v_5$ çš„å¯¼æ•°å€¼ï¼Œå³ $\overline{v}_5=\overline{y}=1$
2. è®¡ç®— y å¯¹ $v_4$ çš„å¯¼æ•°å€¼ï¼Œ$\overline{v}_4=\overline{v}_5\frac{\delta{v_5}}{\delta{v_4}}=1$
3. è®¡ç®— y å¯¹ $v_3$ çš„å¯¼æ•°å€¼ï¼Œ$\overline{v}_3=\overline{v}_5\frac{\delta{v_5}}{\delta{v_3}}=-1$
4. è®¡ç®— y å¯¹ $v_1$ çš„å¯¼æ•°å€¼ï¼Œ$\overline{v}_1=\overline{v}_4\frac{\delta{v_4}}{\delta{v_1}}=1$
5. è®¡ç®— y å¯¹ $v_2$ çš„å¯¼æ•°å€¼ï¼Œ$\overline{v}_2=\overline{v}_4\frac{\delta{v_4}}{\delta{v_1}}=1$
6. æ¥ä¸‹æ¥è¦è®¡ç®— y å¯¹ $v_0$ çš„å¯¼æ•°å€¼å’Œ y å¯¹ $v_{-1}$ çš„å¯¼æ•°å€¼ï¼Œå› ä¸º $v_0$ å’Œ $v_{-1}$ éƒ½æ˜¯åç»­æœ‰ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œå› æ­¤éœ€è¦åˆ†å¼€è®¡ç®—ã€‚
7. è®¡ç®— $\frac{\delta{v_3}}{\delta{v_0}}=cosv_0=0.284$
8. è®¡ç®— $\frac{\delta{v_2}}{\delta{v_0}}=v_{-1}=2$
9. è®¡ç®— $\frac{\delta{v_2}}{\delta{v_{-1}}}=v_0=5$
10. è®¡ç®— $\frac{\delta{v_1}}{\delta{v_{-1}}}=\frac{1}{x_1}=0.5$

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»è®¡ç®—å‡ºæ¥äº†æ‰€æœ‰æ­¥éª¤çš„åå¯¼æ•°çš„æ•°å€¼ã€‚ç°åœ¨éœ€è¦è®¡ç®— $\overline{v}_1$ å’Œ $\overline{v}_2$ ã€‚è®¡ç®— $\overline{v}_1$ ä»æœ€åçš„ä½ç½®å¾€å‰åˆ°è‡ªå˜é‡ x_1ï¼Œæœ‰å¤šæ¡è·¯å¾„ï¼Œéœ€è¦å°†è¿™ä¸ªè·¯å¾„ä¸Šçš„æ•°å€¼è¿ä¹˜èµ·æ¥å¾—åˆ°ä¸€ä¸ªä¹˜ç§¯æ•°å€¼ï¼Œç„¶åå°†è¿™å¤šæ¡è·¯å¾„çš„ä¹˜ç§¯æ•°å€¼ç›¸åŠ èµ·æ¥å¾—åˆ°æœ€åçš„ç»“æœã€‚

ä» y åˆ° x_1 çš„è·¯å¾„æœ‰ä¸¤æ¡ï¼Œåˆ†åˆ«æ˜¯ï¼š

1. $v_5 \to v_4 \to v_1 \to v_{-1}$ï¼Œå…¶æ•°å€¼ä¹˜ç§¯æ˜¯ 1âˆ—1âˆ—0.5=0.5

2. $v_5 \to v_4 \to v_2 \to v_{-1}$ï¼Œå…¶æ•°å€¼ä¹˜ç§¯æ˜¯ 1âˆ—1âˆ— 5= 5

å› æ­¤ï¼Œ$\overline{v}_1=0.5+5=5.5$ï¼ŒåŒç†æœ‰ $\overline{v}_2=2.0-0.284=1.716$

### å‘é‡-é›…å…‹æ¯”çŸ©é˜µ

å¯¹äºå‡½æ•° $\overline{y}=f(\overline{x})$ï¼Œå…¶ä¸­ $f: \mathbb{R}^{n} \rightarrow \mathbb{R}^{m}$ï¼Œé‚£ä¹ˆ $\overline{y}$ ä¸­å…³äº $\overline{x}$ çš„æ¢¯åº¦å¯ä»¥è¡¨ç¤ºä¸º Jacobian çŸ©é˜µï¼š

$$
J_{f}=
\left[\begin{array}{ccc}
\dfrac{\partial y}{\partial x_{1}} & \cdots & \dfrac{\partial y}{\partial x_{1}}
\end{array}\right]=
\left[\begin{array}{ccc}
\dfrac{\partial y_{1}}{\partial x_{1}} & \cdots & \dfrac{\partial y_{1}}{\partial x_{n}} \\
\vdots & \ddots & \vdots \\
\dfrac{\partial y_{m}}{\partial x_{1}} & \cdots & \dfrac{\partial y_{m}}{\partial x_{n}}
\end{array}\right]
$$

è®¾ç½® $\overline{v}$ æ˜¯å…³äºå‡½æ•° $l=g(\overline{y})$ çš„æ¢¯åº¦ï¼š

$$
\overline{v}=
\left[\begin{array}{lll}
\dfrac{\partial l}{\partial y_{1}} &
\cdots &
\dfrac{\partial l}{\partial y_{m}}
\end{array}\right]^{\mathrm{T}}
$$

Jacobian-vector ç§¯å°±æ˜¯å‡½æ•° l ä¸­å…³äº x_1 çš„æ¢¯åº¦ï¼š

$$
\boldsymbol{J} \cdot \overline{v}=
\left[\begin{array}{ccc}
\dfrac{\partial y_{1}}{\partial x_{1}} & \cdots &
\dfrac{\partial y_{1}}{\partial x_{n}} \\
\vdots & \ddots & \vdots \\
\dfrac{\partial y_{m}}{\partial x_{1}} & \cdots &
\dfrac{\partial y_{m}}{\partial x_{n}}
\end{array}\right] \cdot\left[\begin{array}{c}
\dfrac{\partial l}{\partial y_{1}} \\
\vdots \\
\dfrac{\partial l}{\partial y_{m}}
\end{array}\right]=\left[\begin{array}{c}
\dfrac{\partial y_{1}}{\partial x_{1}} \\
\vdots \\
\dfrac{\partial y_{m}}{\partial x_{1}}
\end{array}\right]
$$

å³é€šè¿‡é›…å…‹æ¯”çŸ©é˜µè½¬ç½®ä¸åç»­èŠ‚ç‚¹æ¢¯åº¦å€¼çš„ä¹˜ç§¯ï¼Œå¯ä»¥å¾—åˆ°å½“å‰èŠ‚ç‚¹çš„æ¢¯åº¦å€¼ã€‚

### ä¼˜ç¼ºç‚¹

å‰å‘æ¨¡å¼åœ¨è®¡ç®—ä¹‹ä¸­ï¼Œè®¡ç®—å›¾å„ä¸ªèŠ‚ç‚¹çš„æ•°å€¼å’Œè¯¥èŠ‚ç‚¹çš„å¯¼æ•°å¯åŒæ­¥æ±‚å‡ºï¼Œä½†æ˜¯ä»£ä»·å°±æ˜¯å¯¹äºå¤šä¸ªè¾“å…¥éœ€è¦å¤šæ¬¡è®¡ç®—æ‰è¡Œã€‚

åå‘æ¨¡å¼çš„ä¼˜ç‚¹ï¼š

- é€šè¿‡ä¸€æ¬¡åå‘ä¼ è¾“ï¼Œå°±è®¡ç®—å‡ºæ‰€æœ‰åå¯¼æ•°ï¼Œä¸­é—´çš„åå¯¼æ•°è®¡ç®—åªéœ€è®¡ç®—ä¸€æ¬¡

- å‡å°‘äº†é‡å¤è®¡ç®—çš„å·¥ä½œé‡ï¼Œåœ¨å¤šå‚æ•°çš„æ—¶å€™åå‘è‡ªåŠ¨å¾®åˆ†çš„æ—¶é—´å¤æ‚åº¦æ›´ä½

åå‘æ¨¡å¼çš„ç¼ºç‚¹ï¼š

- éœ€è¦é¢å¤–çš„æ•°æ®ç»“æ„è®°å½•æ­£å‘è¿‡ç¨‹çš„è®¡ç®—æ“ä½œï¼Œç”¨äºåå‘ä½¿ç”¨

- å¸¦æ¥äº†å¤§é‡å†…å­˜å ç”¨ï¼Œä¸ºäº†å‡å°‘å†…å­˜æ“ä½œï¼Œéœ€è¦æ·±åº¦å­¦ä¹ æ¡†æ¶è¿›è¡Œå„ç§ä¼˜åŒ–ï¼Œä¹Ÿå¸¦æ¥äº†é¢å¤–é™åˆ¶å’Œå‰¯ä½œç”¨

## æ­£åå‘æ¨¡å¼çš„æ¯”è¾ƒ

å‰å‘è‡ªåŠ¨å¾®åˆ†ï¼ˆtangent mode ADå’Œåå‘è‡ªåŠ¨å¾®åˆ†ï¼ˆadjoint mode ADï¼‰åˆ†åˆ«è®¡ç®—äº†JacobiançŸ©é˜µçš„ä¸€åˆ—å’Œä¸€è¡Œã€‚

![](../../../Frontend/02_AutoDiff/images/tangent_adjoint.png)

å‰å‘æ¨¡å¼å’Œåå‘æ¨¡å¼çš„ä¸åŒä¹‹å¤„åœ¨äºçŸ©é˜µç›¸ä¹˜çš„èµ·å§‹ä¹‹å¤„ä¸åŒã€‚

å½“è¾“å‡ºç»´åº¦å°äºè¾“å…¥ç»´åº¦ï¼Œåå‘æ¨¡å¼çš„ä¹˜æ³•æ¬¡æ•°è¦å°äºå‰å‘æ¨¡å¼ã€‚å› æ­¤ï¼Œå½“è¾“å‡ºçš„ç»´åº¦å¤§äºè¾“å…¥çš„æ—¶å€™ï¼Œé€‚å®œä½¿ç”¨å‰å‘æ¨¡å¼å¾®åˆ†ï¼›å½“è¾“å‡ºç»´åº¦è¿œè¿œå°äºè¾“å…¥çš„æ—¶å€™ï¼Œé€‚å®œä½¿ç”¨åå‘æ¨¡å¼å¾®åˆ†ã€‚

å³ï¼Œåå‘è‡ªåŠ¨å¾®åˆ†æ›´åŠ é€‚åˆå¤šå‚æ•°çš„æƒ…å†µï¼Œå¤šå‚æ•°çš„æ—¶å€™åå‘è‡ªåŠ¨å¾®åˆ†çš„æ—¶é—´å¤æ‚åº¦æ›´ä½ï¼Œåªéœ€è¦ä¸€éreverse modeçš„è®¡ç®—è¿‡ç¨‹ï¼Œä¾¿å¯ä»¥æ±‚å‡ºè¾“å‡ºå¯¹äºå„ä¸ªè¾“å…¥çš„å¯¼æ•°ï¼Œä»è€Œè½»æ¾æ±‚å–æ¢¯åº¦ç”¨äºåç»­ä¼˜åŒ–æ›´æ–°ã€‚

å› æ­¤ï¼Œç›®å‰å¤§éƒ¨åˆ†AIæ¡†æ¶éƒ½ä¼šä¼˜å…ˆé‡‡ç”¨åå‘æ¨¡å¼ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¾‹å¦‚MindSporeç­‰AIæ¡†æ¶åŒäº‹æ”¯æŒæ­£åå‘çš„å®ç°æ¨¡å¼ã€‚

## å‚è€ƒ

[1] Automatic Differentiation in Machine Learning: a Survey: https://arxiv.org/abs/1502.05767

[2] Rirchard L. Burden and J. Douglas Faires. Numerical Analysis. Brooks/Cole, 2001.

[3] Max E. Jerrell. Automatic differentiation and interval arithmetic for estimation of disequilibrium models. Computational Economics, 10(3):295â€“316, 1997.

[4] Johannes Grabmeier and Erich Kaltofen. Computer Algebra Handbook: Foundations, Applications, Systems. Springer, 2003.

[5] G. W. Leibniz. Machina arithmetica in qua non additio tantum et subtractio sed et multiplicatio nullo, diviso vero paene nullo animi labore peragantur. Hannover, 1685.

[6] George F. Corliss. Application of differentiation arithmetic, volume 19 of Perspectives in Computing, pages 127â€“48. Academic Press, Boston, 1988.

[7] Arun Verma. An introduction to automatic differentiation. Current Science, 78(7):804â€“7, 2000.

[8] Andreas Griewank and Andrea Walther. Evaluating Derivatives: Principles and Techniques of Algorithmic Differentiation. Society for Industrial and Applied Mathematics, Philadelphia, 2008. doi: 10.1137/1.9780898717761.

[9] John F. Nolan. Analytical differentiation on a digital computer. Masterâ€™s thesis, Massachusetts Institute of Technology, 1953.

[10] L. M. Beda, L. N. Korolev, N. V. Sukkikh, and T. S. Frolova. Programs for automatic differentiation for the machine BESM (in Russian). Technical report, Institute for Precise Mechanics and Computation Techniques, Academy of Science, Moscow, USSR, 1959.

[11] Robert E. Wengert. A simple automatic derivative evaluation program. Communications of the ACM, 7:463â€“4, 1964.

[12] Andreas Griewank. On automatic differentiation. pages 83â€“108, 1989.

[13] Hascoet, Laurent, and ValÃ©rie Pascual. "The Tapenade automatic differentiation tool: principles, model, and specification." ACM Transactions on Mathematical Software (TOMS) 39.3 (2013): 1-43.

[14] çŸ¥ä¹ä¸“æ ï¼šè‡ªåŠ¨å¾®åˆ†ï¼ˆAutomatic Differentiationï¼‰: https://zhuanlan.zhihu.com/p/61103504

[15] çŸ¥ä¹ä¸“æ ï¼šæ•°å€¼è®¡ç®—æ–¹æ³• ç¬¬å…­ç«  æ•°å€¼ç§¯åˆ†å’Œæ•°å€¼å¾®åˆ†: https://zhuanlan.zhihu.com/p/14

[16] çŸ¥ä¹ä¸“æ ï¼šæŠ€æœ¯åˆ†äº« | ä»è‡ªåŠ¨å¾®åˆ†åˆ°å¯å¾®ç¼–ç¨‹è¯­è¨€è®¾è®¡ https://zhuanlan.zhihu.com/p/393160344

[17] åšå®¢å›­ï¼šæ·±åº¦å­¦ä¹ åˆ©å™¨ä¹‹è‡ªåŠ¨å¾®åˆ† https://www.cnblogs.com/rossiXYZ/p/15395742.html